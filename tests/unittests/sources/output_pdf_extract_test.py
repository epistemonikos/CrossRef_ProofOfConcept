result = ['NIST has recommended such a transition since 2010 [4]. We\nDHE', 'recommend that clients raise the minimum group size to 2048\nbits as soon as server configurations allow. Server opera-', 'tors should move to 2048-bit or larger groups to facilitate\nthis', 'transition. Precomputation for a 2048-bit non-trapdoored\n9', 'group is around 10 times harder than for a 1024-bit\ngroup,', 'so 2048-bit Diffie-Hellman will remain secure barring a\nmajor', 'algorithmic improvement. For implementa- Avoid fixed-prime\n1024-bit groups.', 'tions that must continue to use or support 1024-bit\ngroups', 'for compatibility reasons, generating fresh groups may\nhelp', 'mitigate some of the damage caused by NFS-style\nprecom-', 'putation for very common fixed groups. However, we\nnote', 'that it is possible to create trapdoored primes [20, 44]\nthat', 'are computationally difficult to detect. At minimum,\nclients', "should check that servers' parameters use safe primes or a\nverifiable generation process, such as that proposed in FIPS 186 [38].\nIdeally, the process for generating and validating", 'parameters in TLS should be standardized so as to\nthwart', 'the risk of trapdoors. Our downgrade', "Don't deliberately weaken crypto.", 'attack on export-grade 512-bit Diffie-Hellman groups in\nTLS', 'illustrates the fragility of cryptographic "front doors". Al-\nDHE_EXPORT', 'though the key sizes originally used in were', 'intended to be tractable only to NSA, two decades of\nalgo-', 'rithmic and computational improvements have\nsignificantly', 'lowered the bar to attacks on such key sizes. Despite\nthe', 'eventual relaxation of crypto export restrictions and subse-\nDHE_EXPORT', 'quent attempts to remove support for , the', 'technical debt induced by the additional complexity has\nleft', 'implementations vulnerable for decades. Like FREAK\n[7],', 'our attacks warn of the long-term debilitating effects\nof', 'deliberately weakening cryptography.', '6. DISCLOSURE AND RESPONSE We notified major client and server\ndevelopers about', 'the vulnerabilities discussed in this paper before we\nmade', 'our findings public. Prior to our work, Internet\nExplorer,', 'Chrome, Firefox, and Opera all accepted 512-bit primes,\nwhereas Safari allowed groups as small as 16 bits. As a', 'result of our disclosures, Internet Explorer [37], Firefox,\nand DHE', 'Chrome are transitioning the minimum size of the\ngroups', 'they accept to 1024 bits, and OpenSSL and Safari are\nex-', 'pected to follow suit. On the server side, we notified\nApache,', 'Oracle, IBM, Cisco, and various hosting providers.\nAka-', 'mai has removed all support for export ciphersuites. Many TLS\ndevelopers plan to support a new extension that allows', 'clients and servers to negotiate a few well-known groups of\n2048-bits and higher and to gracefully reject weak ones [19].', '7. CONCLUSION Diffie-Hellman key exchange is a cornerstone of\napplied', 'cryptography, but we find that, as used in practice, it is\noften', 'less secure than widely believed. The problems stem\nfrom', 'the fact that the number field sieve for discrete log allows\nan', 'attacker to perform a single precomputation that\ndepends', 'only on the group, after which computing individual logs\nin', 'that group has a far lower cost. Although this fact is\nwell', "known to cryptographers, it apparently has not been widely\nunderstood by system builders. Likewise, many cryptogra- phers did not\nappreciate that the security of a large fraction of Internet communication\ndepends on Diffie-Hellman key exchanges that use a few small, widely shared\ngroups. A key lesson from this state of affairs is that cryptogra- phers\nand creators of practical systems need to work together more effectively.\nSystem builders should take responsibility for being aware of applicable\ncryptanalytic attacks. Cryp- tographers, for their part, should involve\nthemselves in how crypto is actually being applied, such as through\nengagement with standards efforts and software review. Bridging the per-\nilous gap that separates these communities will be essential for keeping\nfuture systems secure. Acknowledgments The authors wish to thank Michael\nBailey, Daniel Bernstein, Ron Dreslinski, Tanja Lange, Adam Langley, Kenny\nPaterson, Andrei Popov, Ivan Ristic, Edward Snowden, Brian Smith, Martin\nThomson, and Eric Rescorla. This material is based in part upon work\nsupported by the U.S. National Science Foundation under contracts\nCNS-1345254, CNS-1409505, CNS-1518741, and EFRI-1441209, by the Office of\nNaval Research under contract N00014-11-1-0470, by the ERC Starting Grant\n259639 (CRYSP), by the French ANR re- search grant ANR-12-BS02-001-01, by\nthe NSF Graduate Research Fellowship Program under grant DGE-1256260, by\nthe Mozilla Foundation, by a gift from Supermicro, by the Google Ph.D.\nFellowship in Computer Security, by the Morris Wellman Faculty Development\nAssistant Professor- ship, and by an Alfred P. Sloan Foundation Research\nFellow- ship. Some experiments were conducted using the Grid'5000 testbed,\nwhich is supported by INRIA, CNRS, RENATER, and several other universities\nand organizations; additional experiments used UCS hardware donated by\nCisco.", 'S. Bai, C. Bouvier, A. Filbois, P. Gaudry, L.\nImbert, A. Kruppa, F. Morain, E. Thomé, and P. Zimmermann. , an\nimplementation of the number field sieve cado-nfs algorithm, 2014. Release\n2.1.1.', 'R. Barbulescu. Algorithmes de logarithmes discrets\ndans les corps finis. PhD thesis, Université de Lorraine, France,\n2013.', 'R. Barbulescu, P. Gaudry, A. Joux, and E.\nThomé. A heuristic quasi-polynomial algorithm for discrete logarithm\nin finite fields of small characteristic. In Eurocrypt, 2014.', 'E. Barker, W. Barker, W. Burr, W. Polk, and M. Smid.\nNIST Special Publication 800-57: Recommendation for Key Management,\n2007.', 'D. J. Bernstein. How to find smooth parts of\nintegers, 2004. http://cr.yp.to/factorization/smoothparts-20040510.pdf\n.', 'D. J. Bernstein and T. Lange. Batch NFS. In Selected\nAreas in Cryptography, 2014.', 'B. Beurdouche, K. Bhargavan, A. Delignat-Lavaud, C.\nFournet, M. Kohlweiss, A. Pironti, P.-Y. Strub, and J. K. Zinzindohoue. A\nmessy state of the union: Taming the composite state machines of TLS. In\nIEEE Symposium on Security and Privacy, 2015.', 'C. Bouvier, P. Gaudry, L. Imbert, H. Jeljeli, and E.\nThomé. New record for discrete logarithm in a prime finite field of\n180 decimal digits, 2014. http://caramel.loria.fr/p180.txt.', "R. Canetti and H. Krawczyk. Security analysis of\nIKE's signature-based key-exchange protocol. In Crypto, 2002.", 'A. Commeine and I. Semaev. An algorithm to solve\nthe discrete logarithm problem with the number field sieve. In PKC,\n2006.', 'D. Coppersmith. Solving linear equations over GF(2)\nvia block Wiedemann algorithm. Math. Comp., 62(205), 1994.', 'R. Crandall and C. B. Pomerance. Prime Numbers: A\nComputational Perspective. Springer, 2001.', 'B. den Boer. Diffie-Hellman is as strong as\ndiscrete log for certain primes. In Crypto, 1988.', 'W. Diffie and M. E. Hellman. New directions in\ncryptography. IEEE Trans. Inform. Theory, 22(6):644-654, 1976.', 'Z. Durumeric, E. Wustrow, and J. A. Halderman.\nZMap: Fast Internet-wide scanning and its security applications. In Usenix\nSecurity, 2013. M. Friedl, N. Provos, and W. Simpson. Diffie-Hellman\ngroup', 'exchange for the secure shell (SSH) transport layer\nprotocol. RFC 4419, Mar. 2006.', 'W. Geiselmann, H. Kopfer, R. Steinwandt, and E.\nTromer. Improved routing-based linear algebra for the number field sieve.\nIn Information Technology: Coding and Computing, 2005.', 'W. Geiselmann and R. Steinwandt. Non-wafer-scale\nsieving hardware for the NFS: Another attempt to cope with 1024-bit. In\nEurocrypt, 2007. D. Gillmor. Negotiated finite field Diffie-Hellman\nephemeral', 'parameters for TLS. IETF Internet Draft, May\n2015.', 'D. M. Gordon. Designing and detecting trapdoors for\ndiscrete log cryptosystems. In Crypto, 1992.', 'D. M. Gordon. Discrete logarithms in GF(p) using\nthe number field sieve. SIAM J. Discrete Math., 6(1), 1993.', 'D. Harkins and D. Carrel. The Internet key exchange\n(IKE). RFC 2409, Nov. 1998.', 'T. Jager, K. G. Paterson, and J. Somorovsky. One\nbad apple: Backwards compatibility attacks on state-of-the-art\ncryptography. In NDSS, 2013.', 'A. Joux and R. Lercier. Improvements to the general\nnumber field sieve for discrete logarithms in prime fields. A comparison\nwith the Gaussian integer method. Math. Comp., 72(242):953-967,\n2003.', 'C. Kaufman, P. Hoffman, Y. Nir, P. Eronen, and T.\nKivinen. Internet key exchange protocol version 2 (IKEv2). RFC 7296, Oct.\n2014.', 'S. Kent. IP authentication header. RFC 4302, Dec.\n2005.', 'S. Kent. IP encapsulating security payload (ESP).\nRFC 4303, Dec. 2005.', 'T. Kleinjung. Cofactorisation strategies for the\nnumber field sieve and an estimate for the sieving step for factoring 1024\nbit integers, 2006. http://www.hyperelliptic.org/tanja/\nSHARCS/talks06/thorsten.pdf .', 'T. Kleinjung, K. Aoki, J. Franke, A. K. Lenstra, E.\nThomé, J. W. Bos, P. Gaudry, A. Kruppa, P. L. Montgomery, D. A. Osvik,\nH. te Riele, A. Timofeev, and P. Zimmermann. Factorization of a 768-bit RSA\nmodulus. In Crypto, 2010.', 'A. Langley, N. Modadugu, and B. Moeller. Transport\nlayer security (TLS) false start. IETF Internet Draft, 2010.', 'A. K. Lenstra and H. W. Lenstra, Jr., editors. The\nDevelopment of the Number Field Sieve. Springer, 1993.', 'M. Lipacis. Semiconductors: Moore stress =\nstructural industry shift. Technical report, Jefferies, 2012.', 'U. M. Maurer. Towards the equivalence of breaking\nthe Diffie-Hellman protocol and computing discrete logarithms. In Crypto,\n1994. U. M. Maurer and S. Wolf. Diffie-Hellman oracles. In\nCrypto,', '1996.', 'N. Mavrogiannopoulos, F. Vercauteren, V. Velichkov,\nand B. Preneel. A cross-protocol attack on the TLS protocol. In ACM CCS,\npages 62-72, 2012. C. Meadows. Analysis of the Internet key exchange\nprotocol', 'using the NRL protocol analyzer. In IEEE Symposium\non Security and Privacy, 1999.', 'Microsoft Security Bulletin MS15-055. Vulnerability\nin Schannel could allow information disclosure, May 2015.', 'NIST. FIPS PUB 186-4: Digital signature standard,\n2013.', 'Oak Ridge National Laboratory. Introducing Titan,\n2012. https://www.olcf.ornl.gov/titan.', 'H. Orman. The Oakley key determination protocol.\nRFC 2412, Nov. 1998.', 'S. C. Pohlig and M. E. Hellman. An improved\nalgorithm for computing logarithms over GF(p) and its cryptographic\nsignificance (corresp.). Trans. Inform. Theory, 24(1), 1978.', 'J. M. Pollard. A Monte Carlo method for\nfactorization. BIT Numerical Mathematics, 15(3):331-334, 1975.', 'O. Schirokauer. Virtual logarithms. J. Algorithms,\n57(2):140-147, 2005.', 'I. A. Semaev. Special prime numbers and discrete\nlogs in finite prime fields. Math. Comp., 71(237):363-377,\n2002.', "D. Shanks. Class number, a theory of factorization,\nand genera. In Proc. Sympos. Pure Math., volume 20. 1971. Spiegel Staff.\nPrying eyes: Inside the NSA's war on Internet", 'security. Der Spiegel, Dec 2014.\nhttp://www.spiegel.de/international/germany/\ninside-the-nsa-s-war-on-internet-security-a-1010361.html.', 'W. Stein et al. Sage Mathematics Software (Version\n6.5). The Sage Development Team, 2015. http://www.sagemath.org.', 'stud: The scalable TLS unwrapping daemon, 2012.\nhttps://github.com/bumptech/stud/blob/\n19a7f19686bcdbd689c6fbea31f68a276e62d886/stud.c#L593.', 'E. Thomé. Subquadratic computation of vector\ngenerating polynomials and improvement of the block Wiedemann algorithm. J.\nSymbolic Comput., 33(5):757-775, 2002.', 'P. C. Van Oorschot and M. J. Wiener. Parallel\ncollision search with application to hash functions and discrete\nlogarithms. In ACM CCS, 1994.', 'P. C. Van Oorschot and M. J. Wiener. On\nDiffie-Hellman key agreement with short exponents. In Eurocrypt,\n1996.', 'D. Wagner and B. Schneier. Analysis of the SSL 3.0\nprotocol. In 2nd Usenix Workshop on Electronic Commerce, 1996.', 'J. Wagnon. SSL profiles part 5: SSL options, 2013.\nhttps:// devcentral.f5.com/articles/ssl- profiles-part-5-ssl-\noptions.', 'P. Zimmermann et al. GMP-ECM, 2012.\nhttps://gforge.inria.fr/projects/ecm.', 'APEX active/passive exfiltration. Media leak, Aug.\n2009. http://www.spiegel.de/media/media-35671.pdf .', 'Fielded capability: End-to-end VPN SPIN 9 design\nreview. Media leak. http://www.spiegel.de/media/media-35529.pdf\n.', 'FY 2013 congressional budget justification. Media\nleak. http://cryptome.org/2013/08/spy-budget-fy13.pdf .', 'GALLANTWAVE@scale. Media leak.\nhttp://www.spiegel.de/media/media-35514.pdf .', 'Innov8 experiment profile. Media leak.\nhttp://www.spiegel.de/media/media-35509.pdf .', 'Intro to the VPN exploitation process. Media leak,\nSept. 2010. http://www.spiegel.de/media/media-35515.pdf .', 'LONGHAUL - WikiInfo. Media leak.\nhttp://www.spiegel.de/media/media-35533.pdf .', 'POISONNUT - WikiInfo. Media leak.\nhttp://www.spiegel.de/media/media-35519.pdf .', 'SIGINT strategy. Media leak.\nhttp://www.nytimes.com/interactive/2013/11/23/us/\npolitics/23nsa-sigint-strategy-document.html.', 'SPIN 15 VPN story. Media leak.\nhttp://www.spiegel.de/media/media-35522.pdf .', 'TURMOIL/APEX/APEX high level description document.\nMedia leak. http://www.spiegel.de/media/media-35513.pdf .', 'TURMOIL IPsec VPN sessionization. Media leak, Aug.\n2009. http://www.spiegel.de/media/media-35528.pdf .', 'TURMOIL VPN processing. Media leak, Oct. 2009.\nhttp://www.spiegel.de/media/media-35526.pdf .', 'VALIANTSURF (VS): Capability levels. Media leak.\nhttp://www.spiegel.de/media/media-35517.pdf .', 'VALIANTSURF - WikiInfo. Media leak.\nhttp://www.spiegel.de/media/media-35527.pdf .', 'VPN SigDev basics. Media leak.\nhttp://www.spiegel.de/media/media-35520.pdf .', 'What your mother never told you about SIGDEV\nanalysis. Media leak. http://www.spiegel.de/media/media-35551.pdf\n.']
