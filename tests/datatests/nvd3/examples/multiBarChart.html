<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="../build/nv.d3.js"></script>
    <script src="lib/stream_layers.js"></script>

    <style>
        .nv-legendWrap text {
          font-size: 40px;
        }
        .nv-controlsWrap text{
          font-size: 0px;
        }
        .nv-x text{
          /*font-size: 20px;*/
          font-size: 18px;
        }
        .nv-y text{
          font-size: 35px;
        }
        svg {
            display: block;
        }
        html, body, #chart1, svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>

  <div id="chart1" style="height: 1000px;width: 2700px;" class='with-3d-shadow with-transitions'>
      <svg></svg>
  </div>

  <div id="chart2" style="height: 700px;width: 1400px;" class='with-3d-shadow with-transitions'>
      <svg></svg>
  </div>

  <div id="chart3" style="height: 700px;width: 1400px;" class='with-3d-shadow with-transitions'>
      <svg></svg>
  </div>

<script>

    var test_data_x = stream_layers(3,10+Math.random()*100,.1).map(function(data, i) {
        return {
            key: 'Stream' + i,
            values: data
        };
    });

    // var test_data = [
    //   {
    //     'values': [
    //       {'y': 30, 'x': 0},
    //       {'y': 241, 'x': 20},
    //       {'y': 389, 'x': 40},
    //       {'y': 4355, 'x': 60},
    //       {'y': 119150, 'x': 80}
    //     ],
    //     'key': 'success'
    //   }, {
    //     'values': [
    //       {'y': 741, 'x': 0},
    //       {'y': 703, 'x': 20},
    //       {'y': 1070, 'x': 40},
    //       {'y': 993, 'x': 60},
    //       {'y': 2580, 'x': 80}
    //     ],
    //     'key': 'wrong'
    //   }
    //   ]

    // var test_data = [{'values': [{'y': 30, 'x': 0}, {'y': 241, 'x': 20}, {'y': 389, 'x': 40}, {'y': 4355, 'x': 60}, {'y': 119150, 'x': 80}], 'key': 'success'}, {'values': [{'y': 741, 'x': 0}, {'y': 703, 'x': 20}, {'y': 1070, 'x': 40}, {'y': 993, 'x': 60}, {'y': 2580, 'x': 80}], 'key': 'wrong'}]
    // var test_data = [{'values': [{'x': 0, 'y': 30}, {'x': 20, 'y': 415}, {'x': 50, 'y': 4570}, {'x': 80, 'y': 35955}, {'x': 90, 'y': 77901}], 'key': 'success'}, {'values': [{'x': 0, 'y': 741}, {'x': 20, 'y': 1225}, {'x': 50, 'y': 1541}, {'x': 80, 'y': 1466}, {'x': 90, 'y': 1045}], 'key': 'wrong'}]
    // var test_data = [{'values': [{'x': '0% - 10%', 'y': 30}, {'x': '20% - 30%', 'y': 415}, {'x': '50% - 60%', 'y': 4570}, {'x': '80% - 90%', 'y': 35955}, {'x': '90% - 100%', 'y': 77901}], 'key': 'success'}, {'values': [{'x': '0% - 10%', 'y': 741}, {'x': '20% - 30%', 'y': 1225}, {'x': '50% - 60%', 'y': 1541}, {'x': '80% - 90%', 'y': 1466}, {'x': '90% - 100%', 'y': 1045}], 'key': 'wrong'}]

    function graficate(test_data, div, colors){

      var chart;
      nv.addGraph(function() {
          chart = nv.models.multiBarChart()
              .duration(300)
              .margin({bottom: 120, left: 200})
              .groupSpacing(0.1)
              .forceY([0,130252])
          ;

          chart.reduceXTicks(false).staggerLabels(true).color(colors);

          chart.xAxis
              .axisLabel("Rating [%]")
              .axisLabelDistance(65)
              .showMaxMin(false)
          ;

          chart.yAxis
              .axisLabel("Cantidad de referencias")
              .axisLabelDistance(100)
              .tickFormat(d3.format(',.0f'))
          ;

          chart.dispatch.on('renderEnd', function(){
              nv.log('Render Complete');
          });

          d3.select(div)
              .datum(test_data)
              .call(chart);

          nv.utils.windowResize(chart.update);

          chart.dispatch.on('stateChange', function(e) {
              nv.log('New State:', JSON.stringify(e));
          });
          chart.state.dispatch.on('change', function(state){
              nv.log('state', JSON.stringify(state));
          });

          return chart;
      });

    }


    var test_data = [{'key': 'success', 'values': [{'y': 124165, 'x': 'success'}, {'y': 0, 'x': 'wrong'}]}, {'key': 'wrong', 'values': [{'y': 0, 'x': 'success'}, {'y': 6087, 'x': 'wrong'}]}]
    graficate(test_data, '#chart2 svg', ['#388E3C', '#F44336'])
    var test_data =[{'key': 'success_cross_ref', 'values': [{'x': 'success_mendeley', 'y': 0}, {'x': 'success_cross_ref', 'y': 124165}, {'x': 'wrong', 'y': 0}]}, {'key': 'success_mendeley', 'values': [{'x': 'success_mendeley', 'y': 0}, {'x': 'success_cross_ref', 'y': 0}, {'x': 'wrong', 'y': 0}]}, {'key': 'wrong', 'values': [{'x': 'success_mendeley', 'y': 0}, {'x': 'success_cross_ref', 'y': 0}, {'x': 'wrong', 'y': 6087}]}]
    graficate(test_data, '#chart3 svg', ['#388E3C','#388E3C', '#F44336'])
    var test_data = [{'key': 'success', 'values': [{'y': 4, 'x': '0% - 5%'}, {'y': 2, 'x': '5% - 10%'}, {'y': 10, 'x': '10% - 15%'}, {'y': 14, 'x': '15% - 20%'}, {'y': 41, 'x': '20% - 25%'}, {'y': 45, 'x': '25% - 30%'}, {'y': 95, 'x': '30% - 35%'}, {'y': 60, 'x': '35% - 40%'}, {'y': 84, 'x': '40% - 45%'}, {'y': 90, 'x': '45% - 50%'}, {'y': 85, 'x': '50% - 55%'}, {'y': 130, 'x': '55% - 60%'}, {'y': 193, 'x': '60% - 65%'}, {'y': 768, 'x': '65% - 70%'}, {'y': 755, 'x': '70% - 75%'}, {'y': 2639, 'x': '75% - 80%'}, {'y': 6716, 'x': '80% - 85%'}, {'y': 29239, 'x': '85% - 90%'}, {'y': 15269, 'x': '90% - 95%'}, {'y': 67926, 'x': '95% - 100%'}]}, {'key': 'wrong', 'values': [{'y': 615, 'x': '0% - 5%'}, {'y': 20, 'x': '5% - 10%'}, {'y': 62, 'x': '10% - 15%'}, {'y': 44, 'x': '15% - 20%'}, {'y': 93, 'x': '20% - 25%'}, {'y': 118, 'x': '25% - 30%'}, {'y': 265, 'x': '30% - 35%'}, {'y': 227, 'x': '35% - 40%'}, {'y': 237, 'x': '40% - 45%'}, {'y': 285, 'x': '45% - 50%'}, {'y': 267, 'x': '50% - 55%'}, {'y': 281, 'x': '55% - 60%'}, {'y': 211, 'x': '60% - 65%'}, {'y': 343, 'x': '65% - 70%'}, {'y': 182, 'x': '70% - 75%'}, {'y': 257, 'x': '75% - 80%'}, {'y': 380, 'x': '80% - 85%'}, {'y': 1086, 'x': '85% - 90%'}, {'y': 379, 'x': '90% - 95%'}, {'y': 735, 'x': '95% - 100%'}]}]
    //var test_data = [{'values': [{'y': 30, 'x': '0% - 20%'}, {'y': 241, 'x': '20% - 40%'}, {'y': 389, 'x': '40% - 60%'}, {'y': 4355, 'x': '60% - 80%'}, {'y': 119150, 'x': '80% - 100%'}], 'key': 'success'}, {'values': [{'y': 741, 'x': '0% - 20%'}, {'y': 703, 'x': '20% - 40%'}, {'y': 1070, 'x': '40% - 60%'}, {'y': 993, 'x': '60% - 80%'}, {'y': 2580, 'x': '80% - 100%'}], 'key': 'wrong'}]
    //var test_data = [{'values': [{'y': 3, 'x': '0% - 1%'}, {'y': 0, 'x': '1% - 2%'}, {'y': 0, 'x': '2% - 3%'}, {'y': 0, 'x': '3% - 4%'}, {'y': 1, 'x': '4% - 5%'}, {'y': 0, 'x': '5% - 6%'}, {'y': 1, 'x': '6% - 7%'}, {'y': 0, 'x': '7% - 8%'}, {'y': 1, 'x': '8% - 9%'}, {'y': 0, 'x': '9% - 10%'}, {'y': 4, 'x': '10% - 11%'}, {'y': 1, 'x': '11% - 12%'}, {'y': 1, 'x': '12% - 13%'}, {'y': 3, 'x': '13% - 14%'}, {'y': 1, 'x': '14% - 15%'}, {'y': 2, 'x': '15% - 16%'}, {'y': 3, 'x': '16% - 17%'}, {'y': 2, 'x': '17% - 18%'}, {'y': 1, 'x': '18% - 19%'}, {'y': 6, 'x': '19% - 20%'}, {'y': 4, 'x': '20% - 21%'}, {'y': 3, 'x': '21% - 22%'}, {'y': 3, 'x': '22% - 23%'}, {'y': 25, 'x': '23% - 24%'}, {'y': 6, 'x': '24% - 25%'}, {'y': 10, 'x': '25% - 26%'}, {'y': 4, 'x': '26% - 27%'}, {'y': 7, 'x': '27% - 28%'}, {'y': 24, 'x': '28% - 29%'}, {'y': 0, 'x': '29% - 30%'}, {'y': 12, 'x': '30% - 31%'}, {'y': 13, 'x': '31% - 32%'}, {'y': 13, 'x': '32% - 33%'}, {'y': 41, 'x': '33% - 34%'}, {'y': 16, 'x': '34% - 35%'}, {'y': 13, 'x': '35% - 36%'}, {'y': 8, 'x': '36% - 37%'}, {'y': 10, 'x': '37% - 38%'}, {'y': 12, 'x': '38% - 39%'}, {'y': 17, 'x': '39% - 40%'}, {'y': 19, 'x': '40% - 41%'}, {'y': 15, 'x': '41% - 42%'}, {'y': 21, 'x': '42% - 43%'}, {'y': 9, 'x': '43% - 44%'}, {'y': 20, 'x': '44% - 45%'}, {'y': 25, 'x': '45% - 46%'}, {'y': 15, 'x': '46% - 47%'}, {'y': 13, 'x': '47% - 48%'}, {'y': 20, 'x': '48% - 49%'}, {'y': 17, 'x': '49% - 50%'}, {'y': 19, 'x': '50% - 51%'}, {'y': 21, 'x': '51% - 52%'}, {'y': 10, 'x': '52% - 53%'}, {'y': 19, 'x': '53% - 54%'}, {'y': 16, 'x': '54% - 55%'}, {'y': 25, 'x': '55% - 56%'}, {'y': 44, 'x': '56% - 57%'}, {'y': 31, 'x': '57% - 58%'}, {'y': 0, 'x': '58% - 59%'}, {'y': 30, 'x': '59% - 60%'}, {'y': 62, 'x': '60% - 61%'}, {'y': 44, 'x': '61% - 62%'}, {'y': 45, 'x': '62% - 63%'}, {'y': 15, 'x': '63% - 64%'}, {'y': 27, 'x': '64% - 65%'}, {'y': 505, 'x': '65% - 66%'}, {'y': 69, 'x': '66% - 67%'}, {'y': 49, 'x': '67% - 68%'}, {'y': 75, 'x': '68% - 69%'}, {'y': 70, 'x': '69% - 70%'}, {'y': 101, 'x': '70% - 71%'}, {'y': 167, 'x': '71% - 72%'}, {'y': 145, 'x': '72% - 73%'}, {'y': 150, 'x': '73% - 74%'}, {'y': 192, 'x': '74% - 75%'}, {'y': 835, 'x': '75% - 76%'}, {'y': 297, 'x': '76% - 77%'}, {'y': 279, 'x': '77% - 78%'}, {'y': 688, 'x': '78% - 79%'}, {'y': 540, 'x': '79% - 80%'}, {'y': 662, 'x': '80% - 81%'}, {'y': 889, 'x': '81% - 82%'}, {'y': 1307, 'x': '82% - 83%'}, {'y': 1838, 'x': '83% - 84%'}, {'y': 2020, 'x': '84% - 85%'}, {'y': 1707, 'x': '85% - 86%'}, {'y': 1581, 'x': '86% - 87%'}, {'y': 751, 'x': '87% - 88%'}, {'y': 23399, 'x': '88% - 89%'}, {'y': 1801, 'x': '89% - 90%'}, {'y': 3634, 'x': '90% - 91%'}, {'y': 1483, 'x': '91% - 92%'}, {'y': 2494, 'x': '92% - 93%'}, {'y': 3634, 'x': '93% - 94%'}, {'y': 4024, 'x': '94% - 95%'}, {'y': 3868, 'x': '95% - 96%'}, {'y': 2939, 'x': '96% - 97%'}, {'y': 43365, 'x': '97% - 98%'}, {'y': 11010, 'x': '98% - 99%'}, {'y': 6744, 'x': '99% - 100%'}], 'key': 'success'}, {'values': [{'y': 613, 'x': '0% - 1%'}, {'y': 0, 'x': '1% - 2%'}, {'y': 0, 'x': '2% - 3%'}, {'y': 1, 'x': '3% - 4%'}, {'y': 1, 'x': '4% - 5%'}, {'y': 3, 'x': '5% - 6%'}, {'y': 2, 'x': '6% - 7%'}, {'y': 6, 'x': '7% - 8%'}, {'y': 4, 'x': '8% - 9%'}, {'y': 5, 'x': '9% - 10%'}, {'y': 29, 'x': '10% - 11%'}, {'y': 11, 'x': '11% - 12%'}, {'y': 5, 'x': '12% - 13%'}, {'y': 9, 'x': '13% - 14%'}, {'y': 8, 'x': '14% - 15%'}, {'y': 9, 'x': '15% - 16%'}, {'y': 18, 'x': '16% - 17%'}, {'y': 4, 'x': '17% - 18%'}, {'y': 5, 'x': '18% - 19%'}, {'y': 8, 'x': '19% - 20%'}, {'y': 16, 'x': '20% - 21%'}, {'y': 5, 'x': '21% - 22%'}, {'y': 17, 'x': '22% - 23%'}, {'y': 35, 'x': '23% - 24%'}, {'y': 20, 'x': '24% - 25%'}, {'y': 30, 'x': '25% - 26%'}, {'y': 17, 'x': '26% - 27%'}, {'y': 25, 'x': '27% - 28%'}, {'y': 46, 'x': '28% - 29%'}, {'y': 0, 'x': '29% - 30%'}, {'y': 53, 'x': '30% - 31%'}, {'y': 21, 'x': '31% - 32%'}, {'y': 16, 'x': '32% - 33%'}, {'y': 143, 'x': '33% - 34%'}, {'y': 32, 'x': '34% - 35%'}, {'y': 41, 'x': '35% - 36%'}, {'y': 49, 'x': '36% - 37%'}, {'y': 46, 'x': '37% - 38%'}, {'y': 41, 'x': '38% - 39%'}, {'y': 50, 'x': '39% - 40%'}, {'y': 55, 'x': '40% - 41%'}, {'y': 40, 'x': '41% - 42%'}, {'y': 34, 'x': '42% - 43%'}, {'y': 70, 'x': '43% - 44%'}, {'y': 38, 'x': '44% - 45%'}, {'y': 94, 'x': '45% - 46%'}, {'y': 43, 'x': '46% - 47%'}, {'y': 44, 'x': '47% - 48%'}, {'y': 45, 'x': '48% - 49%'}, {'y': 59, 'x': '49% - 50%'}, {'y': 50, 'x': '50% - 51%'}, {'y': 58, 'x': '51% - 52%'}, {'y': 40, 'x': '52% - 53%'}, {'y': 80, 'x': '53% - 54%'}, {'y': 39, 'x': '54% - 55%'}, {'y': 71, 'x': '55% - 56%'}, {'y': 98, 'x': '56% - 57%'}, {'y': 41, 'x': '57% - 58%'}, {'y': 0, 'x': '58% - 59%'}, {'y': 71, 'x': '59% - 60%'}, {'y': 46, 'x': '60% - 61%'}, {'y': 45, 'x': '61% - 62%'}, {'y': 48, 'x': '62% - 63%'}, {'y': 35, 'x': '63% - 64%'}, {'y': 37, 'x': '64% - 65%'}, {'y': 180, 'x': '65% - 66%'}, {'y': 54, 'x': '66% - 67%'}, {'y': 31, 'x': '67% - 68%'}, {'y': 48, 'x': '68% - 69%'}, {'y': 30, 'x': '69% - 70%'}, {'y': 43, 'x': '70% - 71%'}, {'y': 39, 'x': '71% - 72%'}, {'y': 30, 'x': '72% - 73%'}, {'y': 32, 'x': '73% - 74%'}, {'y': 38, 'x': '74% - 75%'}, {'y': 65, 'x': '75% - 76%'}, {'y': 37, 'x': '76% - 77%'}, {'y': 39, 'x': '77% - 78%'}, {'y': 66, 'x': '78% - 79%'}, {'y': 50, 'x': '79% - 80%'}, {'y': 48, 'x': '80% - 81%'}, {'y': 65, 'x': '81% - 82%'}, {'y': 74, 'x': '82% - 83%'}, {'y': 98, 'x': '83% - 84%'}, {'y': 95, 'x': '84% - 85%'}, {'y': 69, 'x': '85% - 86%'}, {'y': 62, 'x': '86% - 87%'}, {'y': 27, 'x': '87% - 88%'}, {'y': 870, 'x': '88% - 89%'}, {'y': 58, 'x': '89% - 90%'}, {'y': 190, 'x': '90% - 91%'}, {'y': 35, 'x': '91% - 92%'}, {'y': 41, 'x': '92% - 93%'}, {'y': 45, 'x': '93% - 94%'}, {'y': 68, 'x': '94% - 95%'}, {'y': 58, 'x': '95% - 96%'}, {'y': 39, 'x': '96% - 97%'}, {'y': 438, 'x': '97% - 98%'}, {'y': 117, 'x': '98% - 99%'}, {'y': 83, 'x': '99% - 100%'}], 'key': 'wrong'}]
    graficate(test_data, '#chart1 svg', ['#388E3C', '#F44336'])

</script>
</body>
</html>
